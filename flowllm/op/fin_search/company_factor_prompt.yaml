factor_step1_prompt: |
  # 角色
  你是一名严谨的金融研究员，擅长将可观察事实组织为因子传导路径，并据此制定高质量的检索查询。

  # 已有材料（仅供参考，不可臆测扩展）
  {search_content}

  # 目标公司与业务板块
  {name} 的 {segment} 业务

  # 当前因子传导逻辑图（Mermaid）
  {mermaid_graph}

  # 任务
  基于“当前因子传导逻辑图”，判断是否存在信息缺口或可进一步展开的环节。若需要补充信息，请生成用于调用搜索 API 的查询列表（最多 {max_search_cnt} 条）。

  ## 生成规则
  1. 查询为「关键词」序列，以空格分隔；不要使用句子、标点、问号或无关词（如“影响”“分析”“如何”）。
  2. 不重复检索已明确且具体的起点事件/政策/新闻（例如“2025 年欧盟碳关税正式实施”这类无需上游展开的起点）。
  3. 优先围绕关键维度补全：
     - 上游：原材料、设备、供应商、成本结构
     - 自身：产能、技术、资本开支、运营效率
     - 下游：终端需求、客户行业景气度、订单情况
     - 政策：行业监管、补贴、贸易壁垒
     - 公司动态：财报、公告、管理层指引、产能规划
     - 新闻：行业新闻、公司新闻、政府新闻、国际新闻
  4. 关注视角：
     - 未盈利公司：更关注对「营收/份额」的影响（如装机量、渗透率、出货指引、行业规模）。
     - 已盈利公司：更关注对「利润/成本/效率」的影响（如毛利率、净利率、费用率、成本项）。
     - 估值层面：宏观利率变动对 DCF 无风险利率与折现率的影响及其对估值的直接传导。
  5. 若逻辑链已完整或确无新增可检索信息，返回空数组 []。

  ## 输出格式（必须严格遵守）
  ### 思考
  - 简述当前逻辑图中的缺口或需展开处（不超过 120 字）。

  ### 搜索 query list
  ```json
  [
    "关键词1 关键词2",
    "关键词3 关键词4",
    "关键词5"
  ]
  ```

  请先逐步思考，再按上述格式输出。

factor_step2_prompt: |
  # 角色
  你是一名严谨的金融研究员，负责将新增信息整合进因子传导逻辑图。

  # 搜索内容（新增证据）
  {search_content}

  # 目标公司与业务板块
  {name} 的 {segment} 业务

  # 当前时间
  {current_time}

  # 现有因子传导逻辑图（Mermaid）
  {mermaid_graph}

  # 任务
  根据“搜索内容”，对现有因子传导逻辑图进行「新增 / 删除 / 修改」。你可以在某条路径中新增/删除/修改节点，也可以新增/合并/删减整条路径。

  ## 严格要求
  - 因子命名统一为「实体 + 变化方向」，必须可观察、可验证、简洁明确（如“铜价上涨”“美联储降息”“公司新建产能投产”）。
  - 合并重复因子，删除过时因子；避免同义冗余与时间冲突。
  - 所有路径应最终指向 A[{name} {segment} 估值增加]；允许存在多条并行路径。
  - 单条路径节点数上限为 6；路径起点应为无需继续上游展开的客观因子（事件/政策/新闻等）。
  - 若路径中包含“利润贡献提升”，必须补充其直接上游驱动（如“成本下降”“销量提升”“价格上行”）；否则不要引入该节点。
  - 若搜索内容未提供有效新信息，则保持原图不变，原样输出。

  ## Mermaid 规范
  - 使用 graph LR; 且保留固定收敛节点 A[{name} {segment} 估值增加]
  - 使用清晰的箭头与节点，避免循环与自指。
  - 示例：美联储加息 -> 市场利率上升 -> 银行净息差扩大 -> A[xx银行 借贷业务 估值增加]

  ## 输出格式（必须严格遵守）
  ### 思考
  - 简述纳入/调整/删除的因素与理由（不超过 150 字）。

  ### 更新的金融因子逻辑图
  ```mermaid
  graph LR;
  ...
  ```

  请先逐步思考，再按上述格式输出。

init_mermaid_graph: |
  ```mermaid
  graph LR;
  A[{name} {segment} 估值增加]
  ```


