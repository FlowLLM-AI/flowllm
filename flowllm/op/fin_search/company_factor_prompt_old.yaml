factor_step1_prompt: |
  # 角色
  你是一名金融专家，擅长金融逻辑推导。
  
  {search_content}
  
  # 目标公司与业务板块
  {name}的{segment}业务
  
  # 当前的金融因子逻辑图
  {mermaid_graph}
  
  # 任务
  基于**当前的金融因子逻辑图**，判断当前因子逻辑图是否存在信息缺口或可进一步展开的环节。
  如有需要，请生成用于补充信息的搜索query list，每条query将单独调用一次搜索API，最多{max_search_cnt}条。
  生成query时请遵循以下原则：
  1. 每一条query要求简洁，只包含关键词，空格分隔。
  2. **无需重复搜索已明确的起点**：如果当前路径起点已是具体事件、具体政策或明确新闻，则无需再为此因子生成搜索query。
  3. **关键因子**：
    - 上游：原材料、设备、供应商、成本结构
    - 自身：产能、技术、资本开支、运营效率
    - 下游：终端需求、客户行业景气度、订单情况
    - 政策：行业监管、补贴、贸易壁垒
    - 公司动态：财报、公告、管理层指引、产能规划
    - 新闻：行业新闻、公司新闻、政府新闻、国际新闻
  4. **关键角度**：
    - 未盈利的公司可以更多的关注因子对于营收的影响，可以是市场占有率的提升，也可以是行业整体营收在未来的提升。
    - 盈利的公司可以更关注因子对于利润的提升。
    - 也可以关注一些宏观角度对估值的直接影响，例如宏观利率的下降可以DCF公式中的无风险利率的下降，进而导致未来现金流的上升，以及估值的提升。
  5. 若当前逻辑链已完整或无新信息可补充，则返回空列表`[]`。
  
  # 输出示例
  ## 思考
  ...
  
  ## 搜索query list
  ```json
  [
    "xxx 需求预测", 
    "xxx 出货指引", 
    "xxx 2025 年装机量"
  ]
  ```
  
  请先一步一步思考，然后按照输出示例返回结果。

factor_step2_prompt: |
  # 角色
  你是一名金融专家，擅长金融逻辑推导。
  
  # 搜索内容
  {search_content}
  
  # 目标公司与业务板块
  {name}的{segment}业务
  
  # 当前时间
  {current_time}
  
  # 当前的金融因子逻辑图
  {mermaid_graph}

  # 任务
  请根据**搜索内容**中提供的信息，更新现有的**当前的金融因子逻辑图**，可以是新增、删除、修改其中的逻辑路径。也可以是在其中一条逻辑路径中新增、删除、修改因子。
  
  ## 要求如下：
  - 合并重复的因子
  - 删除过时的因子
  - 每个因子必须是[实体+变化方向]，同时要求简洁。例如：“黄金上涨”、“美联储降息”、“公司新建产能投产”）。
  - 可以有多条逻辑路径，但所有的逻辑路径最终都会指向A[{name} {segment} 估值增加]这个因子。
  - 每条逻辑路径最多包含6个因子。每条逻辑路径的起点应该是事件、政策或新闻等一些不需要被扩展的客观因子。终点是A[{name} {segment} 估值增加]这个因子。
  - 如果每条逻辑路径的起点是"利润贡献提升"因子，那可以进一步增加上游因子，什么因子导致利润贡献提升的？否则就不要增加该因子。
  - 若搜索内容中无有效新信息，则直接原样输出。
  
  ## 单条逻辑路径示例
  美联储加息 -> 市场利率上升 -> 银行净息差扩大 -> [xx银行 借贷业务 估值增加]
  
  ## 思考角度示例：
  - 未盈利的公司可以更多的关注因子对于营收的影响，可以是市场占有率的提升，也可以是行业整体营收在未来的提升。
  - 盈利的公司可以更关注因子对于利润的提升。
  - 也可以关注一些宏观角度对估值的直接影响，例如宏观利率的下降可以DCF公式中的无风险利率的下降，进而导致未来现金流的上升，以及估值的提升。

  # 输出示例
  ## 思考
  ...
  
  ## 更新的金融因子逻辑图
  ```mermaid
  graph LR;
  ...
  ```
  
  
  请先一步一步思考，然后按照输出示例返回结果。


factor_transmission_prompt: |
  # 因子传导路径分析任务

  ## 目标公司与业务板块
  {name} 的 {segment} 业务

  [no_first]## 搜索内容
  [no_first]{search_content}

  ## 现有因子传导逻辑图
  {mermaid_graph}

  ## 任务目标
  你需要围绕{name}的{segment}业务，根据不同维度的搜索来迭代树状结构的**因子传导路径**。  
  每条路径应从**宏观、行业或公司层面的可观测因子**（如政策变动、原材料价格、产能变化、需求波动等）出发，通过清晰的因果逻辑链，最终传导至[{name} {segment} 估值增加]。
  例如：美联储加息 -> 市场利率上升 -> 银行净息差扩大 -> [xx银行 借贷业务 估值增加]

  ### 任务-更新因子传导逻辑图
  请根据 **搜索内容** 中提供的信息，更新现有的 **因子传导逻辑图**。  
  更新时需满足以下要求：
  - 每个因子必须是**具体、可观察的实体及其变化方向**（例如：“铜价上涨”、“美联储降息”、“公司新建产能投产”）。
  - 若搜索内容中**无有效新信息**，则**保持原图不变**，直接原样输出。

  ### 任务-生成搜索查询
  基于**更新后的因子传导逻辑图**，判断当前路径是否存在信息缺口或可进一步展开的环节。  
  如有需要，请生成用于补充信息的**搜索查询列表**，每条查询将单独调用一次搜索 API。

  生成查询时请遵循以下原则：
  1. **无需重复搜索已明确的起点**：如果当前路径起点已是具体事件、政策或新闻（如“2025年欧盟碳关税正式实施”），则无需再为此因子生成上游查询。
  2. **聚焦关键维度**：可从以下角度展开：
     - 上游：原材料、设备、供应商、成本结构
     - 自身：产能、技术、资本开支、运营效率
     - 下游：终端需求、客户行业景气度、订单情况
     - 政策：行业监管、补贴、贸易壁垒
     - 公司动态：财报、公告、管理层指引、产能规划
  3. 若当前逻辑链已完整或无新信息可补充，则返回空列表`[]`。

  ## 输出示例
  ### 任务一思考
  ...

  ### 任务一输出示例（更新后的 Mermaid 图）
  ```mermaid
  graph LR;  
  B[factor1 增加] -> A[xxx 估值增加]
  ```
  
  ### 任务二思考
  ...
  
  ### 任务二输出示例（搜索查询列表）
  ```json
  [
    "xxx 上游价格",
    "xxx 产能",
    "xxx 需求预测"
  ]
  ```

  请先一步一步思考，然后按照输出示例返回结果。


init_mermaid_graph: |
  ```mermaid
  graph LR;  
  A[{name} {segment} 估值增加]
  ```